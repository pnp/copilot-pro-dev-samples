{
    "$schema": "https://developer.microsoft.com/json-schemas/copilot/plugin/v2.1/schema.json",
    "schema_version": "v2.1",
    "name_for_human": "My Security",
    "description_for_human": "Agent to manage users security settings and groups they own.",
    "description_for_model": "This agent allows users to manage their security settings and groups they own in Microsoft Entra ID. It can list the groups a user belongs to and the groups they own.",
    "contact_email": "help@microsoft.com",
    "namespace": "myagentall",
    "capabilities": {
        "conversation_starters": [
            { "text": "What groups do I belong to?" },
            { "text": "Who are the owners of the 'Marketing Leads' group?" },
            { "text": "Can I join the Sales group?" },
            { "text": "How do I request access to a private group?" },
            { "text": "Which groups have external (guest) users?" },
            { "text": "Who was added or removed from my groups recently?" },
            { "text": "What devices are registered to my account?" },
            { "text": "When was each of my devices last used?" },
            { "text": "What organizations am I a part of?" },
            { "text": "Which org is my default?" },
            { "text": "How do I switch between my organizations?" },
            { "text": "When was my last successful sign-in?" },
            { "text": "Were there any unsuccessful sign-in attempts recently?" },
            { "text": "From which locations have I signed in recently?" },
            { "text": "What devices have I signed in from?" },
            { "text": "Who are the members of the [X] group?" }
        ]
    },
    "functions": [
        {
            "name": "user_ListMemberGroups",
            "description": "List the groups that the current user belongs to."
        },
        {
            "name": "user_ListOwnedGroups",
            "description": "List the groups that the current user owns."
        },
        {
            "name": "me_authentication_ListMethods",
            "description": "List the authentication methods registered by the user."
        },
        {
            "name": "me_ListOwnedDevices",
            "description": "List the devices owned by the user."
        },
        {
            "name": "listSignIns",
            "description": "Summarize the sign-in records for the user."
        },
        {
            "name": "updateGroup",
            "description": "Update the display name or description of a group."
        },
        {
            "name": "addGroupMember",
            "description": "Add a user to a group's members."
        },
        {
            "name": "removeGroupMember",
            "description": "Remove a user from a group's members."
        },
        {
            "name": "getTransitiveMemberships",
            "description": "List all groups, directory roles, or administrative units that the user is a member of, either directly or through nested memberships."
        },
        {
            "name": "listGroups",
            "description": "List groups in the organization, optionally filtered by display name."
        },
        {
            "name": "listGroupMembers",
            "description": "List the members of a specific group by group ID."
        }
    ],
    "runtimes": [
        {
            "type": "OpenApi",
            "auth": {
                "type": "OAuthPluginVault",
                "reference_id": "${{OAUTH2AUTHCODE_CONFIGURATION_ID}}"
            },
            "spec": {
                "url": "myagentall-openapi.yml"
            },
            "run_for_functions": [
                "user_ListOwnedGroups",
                "user_ListMemberGroups",
                "me_authentication_ListMethods",
                "me_ListOwnedDevices",
                "listSignIns",
                "updateGroup",
                "addGroupMember",
                "removeGroupMember",
                "getTransitiveMemberships",
                "listGroups",
                "listGroupMembers"
            ]
        }
    ]
}