{
    "$schema": "https://aka.ms/json-schemas/copilot-extensions/v2.1/plugin.schema.json",
    "schema_version": "v2.4",
    "name_for_human": "Microsoft Learn Search Agent",
    "description_for_human": "Microsoft Learn Search Agent${{APP_NAME_SUFFIX}}",
    "contact_email": "publisher-email@example.com",
    "namespace": "microsoftlearnsearchagent",
    "functions": [
        {
            "name": "microsoft_code_sample_search",
            "description": "Search for code snippets and examples in official Microsoft Learn documentation. This tool retrieves relevant code samples from Microsoft documentation pages providing developers with practical implementation examples and best practices for Microsoft/Azure products and services related coding tasks. This tool will help you use the **LATEST OFFICIAL** code snippets to empower coding capabilities.\n\n## When to Use This Tool\n- When you are going to provide sample Microsoft/Azure related code snippets in your answers.\n- When you are **generating any Microsoft/Azure related code**.\n\n## Usage Pattern\nInput a descriptive query, or SDK/class/method name to retrieve related code samples. The optional parameter `language` can help to filter results.\n\nEligible values for `language` parameter include: csharp javascript typescript python powershell azurecli al sql java kusto cpp go rust ruby php",
            "parameters": {
                "type": "object",
                "properties": {
                    "query": {
                        "description": "a descriptive query, SDK name, method name or code snippet related to Microsoft/Azure products, services, platforms, developer tools, frameworks, APIs or SDKs",
                        "type": "string"
                    },
                    "language": {
                        "description": "Optional parameter specifying the programming language of code snippets to retrieve. Can significantly improve search quality if provided. Eligible values: csharp javascript typescript python powershell azurecli al sql java kusto cpp go rust ruby php",
                        "type": "string",
                        "default": null
                    }
                },
                "required": [
                    "query"
                ]
            }
        },
        {
            "name": "microsoft_docs_fetch",
            "description": "Fetch and convert a Microsoft Learn documentation page to markdown format. This tool retrieves the latest complete content of Microsoft documentation pages including Azure, .NET, Microsoft 365, and other Microsoft technologies.\n\n## When to Use This Tool\n- When search results provide incomplete information or truncated content\n- When you need complete step-by-step procedures or tutorials\n- When you need troubleshooting sections, prerequisites, or detailed explanations\n- When search results reference a specific page that seems highly relevant\n- For comprehensive guides that require full context\n\n## Usage Pattern\nUse this tool AFTER microsoft_docs_search when you identify specific high-value pages that need complete content. The search tool gives you an overview; this tool gives you the complete picture.\n\n## URL Requirements\n- The URL must be a valid link from the microsoft.com domain.\n\n## Output Format\nmarkdown with headings, code blocks, tables, and links preserved.",
            "parameters": {
                "type": "object",
                "properties": {
                    "url": {
                        "description": "URL of the Microsoft documentation page to read",
                        "type": "string"
                    }
                },
                "required": [
                    "url"
                ]
            }
        },
        {
            "name": "microsoft_docs_search",
            "description": "Search official Microsoft/Azure documentation to find the most relevant and trustworthy content for a user's query. This tool returns up to 10 high-quality content chunks (each max 500 tokens), extracted from Microsoft Learn and other official sources. Each result includes the article title, URL, and a self-contained content excerpt optimized for fast retrieval and reasoning. Always use this tool to quickly ground your answers in accurate, first-party Microsoft/Azure knowledge.\n\nThe `question` parameter is no longer used, use `query` instead.\n\n## Follow-up Pattern\nTo ensure completeness, use microsoft_docs_fetch when high-value pages are identified by search. The fetch tool complements search by providing the full detail. This is a required step for comprehensive results.",
            "parameters": {
                "type": "object",
                "properties": {
                    "query": {
                        "description": "a query or topic about Microsoft/Azure products, services, platforms, developer tools, frameworks, or APIs",
                        "type": "string",
                        "default": null
                    },
                    "question": {
                        "description": "this parameter is no longer used, use query instead.",
                        "type": "string",
                        "default": null
                    }
                },
                "required": []
            }
        }
    ],
    "runtimes": [
        {
            "type": "RemoteMCPServer",
            "spec": {
                "url": "https://learn.microsoft.com/api/mcp",
                "enable_dynamic_discovery": false
            },
            "run_for_functions": [
                "microsoft_code_sample_search",
                "microsoft_docs_fetch",
                "microsoft_docs_search"
            ]
        }
    ]
}
